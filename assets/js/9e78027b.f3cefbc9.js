"use strict";(globalThis.webpackChunkmy_docs=globalThis.webpackChunkmy_docs||[]).push([[349],{6391(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"Security-Best-Practices","title":"Security Best Practices","description":"Overview","source":"@site/docs/Security-Best-Practices.md","sourceDirName":".","slug":"/Security-Best-Practices","permalink":"/django-rest-best-practices/Security-Best-Practices","draft":false,"unlisted":false,"editUrl":"https://github.com/pragnakalp/django-rest-best-practices/tree/main/docs/Security-Best-Practices.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Authentication and Permissions Best Practices","permalink":"/django-rest-best-practices/Authentication-and-Permissions"},"next":{"title":"Performance and Optimization Best Practices","permalink":"/django-rest-best-practices/Performance-and-Optimization"}}');var r=s(4848),t=s(8453);const l={},a="Security Best Practices",c={},o=[{value:"Overview",id:"overview",level:2},{value:"OWASP API Security Top 10 (2019)",id:"owasp-api-security-top-10-2019",level:2},{value:"API1:2019 Broken Object Level Authorization",id:"api12019-broken-object-level-authorization",level:3},{value:"The Problem",id:"the-problem",level:4},{value:"Best Practices",id:"best-practices",level:4},{value:"API2:2019 Broken User Authentication",id:"api22019-broken-user-authentication",level:3},{value:"The Problem",id:"the-problem-1",level:4},{value:"Best Practices",id:"best-practices-1",level:4},{value:"API3:2019 Excessive Data Exposure",id:"api32019-excessive-data-exposure",level:3},{value:"The Problem",id:"the-problem-2",level:4},{value:"Best Practices",id:"best-practices-2",level:4},{value:"API4:2019 Lack of Resources &amp; Rate Limiting",id:"api42019-lack-of-resources--rate-limiting",level:3},{value:"The Problem",id:"the-problem-3",level:4},{value:"Comparing Rate Limiting Approaches",id:"comparing-rate-limiting-approaches",level:4},{value:"Decision Matrix for Rate Limiting",id:"decision-matrix-for-rate-limiting",level:4},{value:"Layered Rate Limiting Strategy (Best Practice)",id:"layered-rate-limiting-strategy-best-practice",level:4},{value:"API5:2019 Broken Function Level Authorization",id:"api52019-broken-function-level-authorization",level:3},{value:"The Problem",id:"the-problem-4",level:4},{value:"Best Practices",id:"best-practices-3",level:4},{value:"API6:2019 Mass Assignment",id:"api62019-mass-assignment",level:3},{value:"The Problem",id:"the-problem-5",level:4},{value:"Best Practices",id:"best-practices-4",level:4},{value:"API7:2019 Security Misconfiguration",id:"api72019-security-misconfiguration",level:3},{value:"The Problem",id:"the-problem-6",level:4},{value:"Best Practices",id:"best-practices-5",level:4},{value:"API8:2019 Injection",id:"api82019-injection",level:3},{value:"The Problem",id:"the-problem-7",level:4},{value:"SQL Injection Prevention",id:"sql-injection-prevention",level:4},{value:"Command Injection Prevention",id:"command-injection-prevention",level:4},{value:"YAML/Pickle Injection Prevention",id:"yamlpickle-injection-prevention",level:4},{value:"API9:2019 Improper Assets Management",id:"api92019-improper-assets-management",level:3},{value:"The Problem",id:"the-problem-8",level:4},{value:"Best Practices",id:"best-practices-6",level:4},{value:"API10:2019 Insufficient Logging &amp; Monitoring",id:"api102019-insufficient-logging--monitoring",level:3},{value:"The Problem",id:"the-problem-9",level:4},{value:"Best Practices",id:"best-practices-7",level:4},{value:"Other Security Risks",id:"other-security-risks",level:2},{value:"Business Logic Bugs",id:"business-logic-bugs",level:3},{value:"Secret Management",id:"secret-management",level:3},{value:"Dependency Management",id:"dependency-management",level:2},{value:"Keep Dependencies Updated",id:"keep-dependencies-updated",level:3},{value:"SAST Tools",id:"sast-tools",level:2},{value:"Summary",id:"summary",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"security-best-practices",children:"Security Best Practices"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"This document consolidates security best practices for Django REST Framework based on OWASP API Security Top 10 and industry standards."}),"\n",(0,r.jsx)(n.h2,{id:"owasp-api-security-top-10-2019",children:"OWASP API Security Top 10 (2019)"}),"\n",(0,r.jsx)(n.h3,{id:"api12019-broken-object-level-authorization",children:"API1:2019 Broken Object Level Authorization"}),"\n",(0,r.jsx)(n.h4,{id:"the-problem",children:"The Problem"}),"\n",(0,r.jsx)(n.p,{children:"APIs often expose endpoints that handle object identifiers, creating a wide attack surface. Attackers can manipulate IDs to access data belonging to other users."}),"\n",(0,r.jsx)(n.h4,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Always Check Object Permissions:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from rest_framework import viewsets\nfrom django.shortcuts import get_object_or_404\n\nclass ArticleViewSet(viewsets.ModelViewSet):\n    queryset = Article.objects.all()\n    serializer_class = ArticleSerializer\n    permission_classes = [IsAuthenticated, IsOwnerOrReadOnly]\n    \n    def get_object(self):\n        """\n        Override to ensure object permissions are checked.\n        """\n        obj = get_object_or_404(self.get_queryset(), pk=self.kwargs["pk"])\n        # CRITICAL: Always check object permissions\n        self.check_object_permissions(self.request, obj)\n        return obj\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Never Do This:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# BAD - No permission check\ndef get_object(self):\n    return Article.objects.get(pk=self.kwargs["pk"])\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Filter Queryset by User:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def get_queryset(self):\n    """\n    Users can only access their own articles.\n    """\n    return Article.objects.filter(author=self.request.user)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"api22019-broken-user-authentication",children:"API2:2019 Broken User Authentication"}),"\n",(0,r.jsx)(n.h4,{id:"the-problem-1",children:"The Problem"}),"\n",(0,r.jsx)(n.p,{children:"Poorly implemented authentication mechanisms allow attackers to compromise tokens or exploit implementation flaws."}),"\n",(0,r.jsx)(n.h4,{id:"best-practices-1",children:"Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configure Authentication Properly:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# settings.py - JWT is recommended for modern applications\nREST_FRAMEWORK = {\n    'DEFAULT_AUTHENTICATION_CLASSES': [\n        'rest_framework_simplejwt.authentication.JWTAuthentication',\n    ],\n}\n\nSIMPLE_JWT = {\n    'ACCESS_TOKEN_LIFETIME': timedelta(minutes=15),\n    'REFRESH_TOKEN_LIFETIME': timedelta(days=7),\n    'ROTATE_REFRESH_TOKENS': True,\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Alternative for Traditional Web Apps:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# For applications requiring both web and mobile support\nREST_FRAMEWORK = {\n    'DEFAULT_AUTHENTICATION_CLASSES': [\n        'rest_framework_simplejwt.authentication.JWTAuthentication',\n        'rest_framework.authentication.SessionAuthentication',\n    ],\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Never Override Without Understanding:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# BAD - Disabling authentication without understanding\nclass UnsafeView(APIView):\n    authentication_classes = []  # Dangerous!\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Good - Explicit Authentication:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class SecureView(APIView):\n    authentication_classes = [JWTAuthentication]\n    permission_classes = [IsAuthenticated]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implement JWT Token Expiration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# JWT handles expiration automatically, but configure properly:\nSIMPLE_JWT = {\n    'ACCESS_TOKEN_LIFETIME': timedelta(minutes=15),  # Short-lived access tokens\n    'REFRESH_TOKEN_LIFETIME': timedelta(days=7),     # Longer refresh tokens\n    'ROTATE_REFRESH_TOKENS': True,                   # Security best practice\n    'BLACKLIST_AFTER_ROTATION': True,                # Invalidate old refresh tokens\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Legacy Token Expiration (if using Token Authentication):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from datetime import timedelta\nfrom django.utils import timezone\n\ndef is_token_expired(token):\n    """Check if token is older than 24 hours"""\n    time_elapsed = timezone.now() - token.created\n    return time_elapsed > timedelta(hours=24)\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Rate Limit Authentication Endpoints:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.throttling import AnonRateThrottle\n\nclass LoginRateThrottle(AnonRateThrottle):\n    rate = '5/hour'\n\nclass LoginView(APIView):\n    throttle_classes = [LoginRateThrottle]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"api32019-excessive-data-exposure",children:"API3:2019 Excessive Data Exposure"}),"\n",(0,r.jsx)(n.h4,{id:"the-problem-2",children:"The Problem"}),"\n",(0,r.jsx)(n.p,{children:"APIs return more data than necessary, relying on clients to filter. Attackers can access sensitive data not intended for them."}),"\n",(0,r.jsx)(n.h4,{id:"best-practices-2",children:"Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Explicit Field Lists:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# BAD - Exposes all fields\nclass UserSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = User\n        fields = '__all__'  # NEVER DO THIS\n\n# BAD - Denylist approach\nclass UserSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = User\n        exclude = ['password']  # Still risky\n\n# GOOD - Allowlist approach\nclass UserSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = User\n        fields = ['id', 'username', 'email', 'first_name', 'last_name']\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Different Serializers for Different Contexts:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class UserListSerializer(serializers.ModelSerializer):\n    \"\"\"Minimal data for list view\"\"\"\n    class Meta:\n        model = User\n        fields = ['id', 'username']\n\nclass UserDetailSerializer(serializers.ModelSerializer):\n    \"\"\"More data for detail view\"\"\"\n    class Meta:\n        model = User\n        fields = ['id', 'username', 'email', 'first_name', 'last_name', 'date_joined']\n\nclass UserViewSet(viewsets.ModelViewSet):\n    queryset = User.objects.all()\n    \n    def get_serializer_class(self):\n        if self.action == 'list':\n            return UserListSerializer\n        return UserDetailSerializer\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Hide Sensitive Fields:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class UserSerializer(serializers.ModelSerializer):\n    password = serializers.CharField(write_only=True)  # Never return password\n    \n    class Meta:\n        model = User\n        fields = ['id', 'username', 'email', 'password']\n"})}),"\n",(0,r.jsx)(n.h3,{id:"api42019-lack-of-resources--rate-limiting",children:"API4:2019 Lack of Resources & Rate Limiting"}),"\n",(0,r.jsx)(n.h4,{id:"the-problem-3",children:"The Problem"}),"\n",(0,r.jsx)(n.p,{children:"Without rate limiting, APIs are vulnerable to DoS attacks and resource exhaustion."}),"\n",(0,r.jsx)(n.h4,{id:"comparing-rate-limiting-approaches",children:"Comparing Rate Limiting Approaches"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Approach 1: DRF Built-in Throttling (Simple)"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# settings.py\nREST_FRAMEWORK = {\n    'DEFAULT_THROTTLE_CLASSES': [\n        'rest_framework.throttling.AnonRateThrottle',\n        'rest_framework.throttling.UserRateThrottle'\n    ],\n    'DEFAULT_THROTTLE_RATES': {\n        'anon': '100/hour',\n        'user': '1000/hour'\n    }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Built into DRF"}),"\n",(0,r.jsx)(n.li,{children:"Easy to configure"}),"\n",(0,r.jsx)(n.li,{children:"Per-user and anonymous limits"}),"\n",(0,r.jsx)(n.li,{children:"No external dependencies"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Stored in cache (memory/Redis)"}),"\n",(0,r.jsx)(n.li,{children:"Not distributed by default"}),"\n",(0,r.jsx)(n.li,{children:"Limited customization"}),"\n",(0,r.jsx)(n.li,{children:"Can be bypassed with IP rotation"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use When:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Small to medium applications"}),"\n",(0,r.jsx)(n.li,{children:"Simple rate limiting needs"}),"\n",(0,r.jsx)(n.li,{children:"Already using Django cache"}),"\n",(0,r.jsx)(n.li,{children:"Single server deployment"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Approach 2: Django-ratelimit (More Flexible)"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# pip install django-ratelimit\nfrom django_ratelimit.decorators import ratelimit\n\n@ratelimit(key='ip', rate='5/m', method='POST')\n@api_view(['POST'])\ndef login_view(request):\n    # Login logic\n    pass\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"More flexible rate keys"}),"\n",(0,r.jsx)(n.li,{children:"IP-based limiting"}),"\n",(0,r.jsx)(n.li,{children:"Method-specific rates"}),"\n",(0,r.jsx)(n.li,{children:"Good for function-based views"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Separate from DRF"}),"\n",(0,r.jsx)(n.li,{children:"Different syntax"}),"\n",(0,r.jsx)(n.li,{children:"Less integration"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use When:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Need IP-based limiting"}),"\n",(0,r.jsx)(n.li,{children:"Function-based views"}),"\n",(0,r.jsx)(n.li,{children:"More granular control"}),"\n",(0,r.jsx)(n.li,{children:"Specific endpoint protection"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Approach 3: WAF/API Gateway (Production)"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Cloudflare, AWS WAF, Kong, etc.\n# Configure at infrastructure level\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Best performance"}),"\n",(0,r.jsx)(n.li,{children:"Distributed by default"}),"\n",(0,r.jsx)(n.li,{children:"Advanced features (geo-blocking, bot detection)"}),"\n",(0,r.jsx)(n.li,{children:"Protects before hitting application"}),"\n",(0,r.jsx)(n.li,{children:"DDoS protection"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Additional cost"}),"\n",(0,r.jsx)(n.li,{children:"External dependency"}),"\n",(0,r.jsx)(n.li,{children:"More complex setup"}),"\n",(0,r.jsx)(n.li,{children:"Requires infrastructure access"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use When:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Production environments"}),"\n",(0,r.jsx)(n.li,{children:"High-traffic applications"}),"\n",(0,r.jsx)(n.li,{children:"Need DDoS protection"}),"\n",(0,r.jsx)(n.li,{children:"Multi-server deployment"}),"\n",(0,r.jsx)(n.li,{children:"Budget allows"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Approach 4: Redis-based Custom (Scalable)"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import redis\nfrom rest_framework.throttling import SimpleRateThrottle\n\nclass RedisRateThrottle(SimpleRateThrottle):\n    cache = redis.Redis(host='localhost', port=6379, db=0)\n    \n    def get_cache_key(self, request, view):\n        return f\"throttle:{request.user.id}:{view.__class__.__name__}\"\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Distributed across servers"}),"\n",(0,r.jsx)(n.li,{children:"Fast performance"}),"\n",(0,r.jsx)(n.li,{children:"Scalable"}),"\n",(0,r.jsx)(n.li,{children:"Custom logic possible"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Requires Redis"}),"\n",(0,r.jsx)(n.li,{children:"More code to maintain"}),"\n",(0,r.jsx)(n.li,{children:"Complexity"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use When:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Multi-server deployment"}),"\n",(0,r.jsx)(n.li,{children:"Need distributed rate limiting"}),"\n",(0,r.jsx)(n.li,{children:"High scalability required"}),"\n",(0,r.jsx)(n.li,{children:"Already using Redis"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"decision-matrix-for-rate-limiting",children:"Decision Matrix for Rate Limiting"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Scenario"}),(0,r.jsx)(n.th,{children:"Recommended Approach"}),(0,r.jsx)(n.th,{children:"Why"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Single server"}),(0,r.jsx)(n.td,{children:"DRF built-in"}),(0,r.jsx)(n.td,{children:"Simple, sufficient"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Multi-server"}),(0,r.jsx)(n.td,{children:"Redis-based or WAF"}),(0,r.jsx)(n.td,{children:"Distributed state"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"High traffic"}),(0,r.jsx)(n.td,{children:"WAF/API Gateway"}),(0,r.jsx)(n.td,{children:"Best performance"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Development"}),(0,r.jsx)(n.td,{children:"DRF built-in"}),(0,r.jsx)(n.td,{children:"Easy setup"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Production SaaS"}),(0,r.jsx)(n.td,{children:"WAF + DRF"}),(0,r.jsx)(n.td,{children:"Layered protection"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Budget constrained"}),(0,r.jsx)(n.td,{children:"DRF built-in"}),(0,r.jsx)(n.td,{children:"No extra cost"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Enterprise"}),(0,r.jsx)(n.td,{children:"WAF/API Gateway"}),(0,r.jsx)(n.td,{children:"Advanced features"})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"layered-rate-limiting-strategy-best-practice",children:"Layered Rate Limiting Strategy (Best Practice)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Layer 1: WAF/API Gateway (infrastructure)\n# - 10,000 requests/minute per IP\n# - DDoS protection\n# - Bot detection\n\n# Layer 2: DRF Throttling (application)\nREST_FRAMEWORK = {\n    'DEFAULT_THROTTLE_CLASSES': [\n        'rest_framework.throttling.AnonRateThrottle',\n        'rest_framework.throttling.UserRateThrottle',\n        'rest_framework.throttling.ScopedRateThrottle',\n    ],\n    'DEFAULT_THROTTLE_RATES': {\n        'anon': '100/hour',\n        'user': '1000/hour',\n        'login': '5/hour',  # Stricter for sensitive endpoints\n    }\n}\n\n# Layer 3: Endpoint-specific (critical operations)\nclass ExpensiveOperationView(APIView):\n    throttle_classes = [UserRateThrottle]\n    throttle_scope = 'expensive'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Why Layered Approach:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"WAF blocks obvious attacks"}),"\n",(0,r.jsx)(n.li,{children:"DRF handles legitimate users"}),"\n",(0,r.jsx)(n.li,{children:"Endpoint-specific protects critical operations"}),"\n",(0,r.jsx)(n.li,{children:"Defense in depth"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Custom Throttle Classes:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.throttling import UserRateThrottle\n\nclass BurstRateThrottle(UserRateThrottle):\n    rate = '60/min'\n\nclass SustainedRateThrottle(UserRateThrottle):\n    rate = '1000/day'\n\nclass ArticleViewSet(viewsets.ModelViewSet):\n    throttle_classes = [BurstRateThrottle, SustainedRateThrottle]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Per-View Throttling:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class ExpensiveOperationView(APIView):\n    throttle_classes = [UserRateThrottle]\n    throttle_scope = 'expensive_operation'\n\n# settings.py\nREST_FRAMEWORK = {\n    'DEFAULT_THROTTLE_RATES': {\n        'expensive_operation': '10/hour',\n    }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implement Pagination:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# settings.py\nREST_FRAMEWORK = {\n    'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',\n    'PAGE_SIZE': 20\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Important:"})," Use WAF or similar for primary rate limiting. DRF throttling should be the last layer."]}),"\n",(0,r.jsx)(n.h3,{id:"api52019-broken-function-level-authorization",children:"API5:2019 Broken Function Level Authorization"}),"\n",(0,r.jsx)(n.h4,{id:"the-problem-4",children:"The Problem"}),"\n",(0,r.jsx)(n.p,{children:"APIs don't properly enforce authorization checks on functions, allowing users to access admin or privileged functions."}),"\n",(0,r.jsx)(n.h4,{id:"best-practices-3",children:"Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Change Default Permission:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# settings.py\nREST_FRAMEWORK = {\n    'DEFAULT_PERMISSION_CLASSES': [\n        'rest_framework.permissions.IsAuthenticated',  # Not AllowAny!\n    ],\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Never Use AllowAny Globally:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# BAD\nREST_FRAMEWORK = {\n    'DEFAULT_PERMISSION_CLASSES': [\n        'rest_framework.permissions.AllowAny',  # Dangerous default\n    ],\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Explicit Permissions Per View:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.permissions import IsAuthenticated, IsAdminUser\n\nclass PublicArticleList(APIView):\n    permission_classes = [AllowAny]  # Explicitly public\n\nclass AdminOnlyView(APIView):\n    permission_classes = [IsAdminUser]  # Admin only\n\nclass UserArticleView(APIView):\n    permission_classes = [IsAuthenticated]  # Authenticated users\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Function-Level Permissions:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class ArticleViewSet(viewsets.ModelViewSet):\n    queryset = Article.objects.all()\n    serializer_class = ArticleSerializer\n    \n    def get_permissions(self):\n        if self.action in ['list', 'retrieve']:\n            permission_classes = [AllowAny]\n        elif self.action == 'create':\n            permission_classes = [IsAuthenticated]\n        elif self.action in ['update', 'partial_update', 'destroy']:\n            permission_classes = [IsAuthenticated, IsOwnerOrAdmin]\n        else:\n            permission_classes = [IsAdminUser]\n        \n        return [permission() for permission in permission_classes]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"api62019-mass-assignment",children:"API6:2019 Mass Assignment"}),"\n",(0,r.jsx)(n.h4,{id:"the-problem-5",children:"The Problem"}),"\n",(0,r.jsx)(n.p,{children:"Binding client-provided data to data models without proper filtering allows attackers to modify object properties they shouldn't."}),"\n",(0,r.jsx)(n.h4,{id:"best-practices-4",children:"Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Explicit Fields (Allowlist):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# GOOD - Explicit field list\nclass UserSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = User\n        fields = ['username', 'email', 'first_name', 'last_name']\n\n# BAD - Excludes fields (denylist)\nclass UserSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = User\n        exclude = ['is_staff', 'is_superuser']  # Risky\n\n# NEVER DO THIS\nclass UserSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = User\n        fields = '__all__'  # Exposes everything\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Read-Only Fields:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class UserSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = User\n        fields = ['id', 'username', 'email', 'is_staff', 'date_joined']\n        read_only_fields = ['id', 'is_staff', 'date_joined']\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Separate Serializers for Read/Write:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class UserReadSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = User\n        fields = ['id', 'username', 'email', 'is_staff', 'date_joined']\n\nclass UserWriteSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = User\n        fields = ['username', 'email', 'first_name', 'last_name']\n\nclass UserViewSet(viewsets.ModelViewSet):\n    queryset = User.objects.all()\n    \n    def get_serializer_class(self):\n        if self.action in ['create', 'update', 'partial_update']:\n            return UserWriteSerializer\n        return UserReadSerializer\n"})}),"\n",(0,r.jsx)(n.h3,{id:"api72019-security-misconfiguration",children:"API7:2019 Security Misconfiguration"}),"\n",(0,r.jsx)(n.h4,{id:"the-problem-6",children:"The Problem"}),"\n",(0,r.jsx)(n.p,{children:"Insecure default configurations, incomplete configurations, or verbose error messages expose the system to attacks."}),"\n",(0,r.jsx)(n.h4,{id:"best-practices-5",children:"Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Production Settings:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# settings.py - Production\nDEBUG = False\nDEBUG_PROPAGATE_EXCEPTIONS = False\n\nALLOWED_HOSTS = ['yourdomain.com', 'api.yourdomain.com']\n\n# Generate strong secret key\nSECRET_KEY = os.environ.get('SECRET_KEY')  # Never hardcode!\n\n# HTTPS settings\nSECURE_SSL_REDIRECT = True\nSESSION_COOKIE_SECURE = True\nCSRF_COOKIE_SECURE = True\nSECURE_BROWSER_XSS_FILTER = True\nSECURE_CONTENT_TYPE_NOSNIFF = True\nX_FRAME_OPTIONS = 'DENY'\n\n# HSTS\nSECURE_HSTS_SECONDS = 31536000  # 1 year\nSECURE_HSTS_INCLUDE_SUBDOMAINS = True\nSECURE_HSTS_PRELOAD = True\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Disable Browsable API in Production:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# settings.py\nREST_FRAMEWORK = {\n    'DEFAULT_RENDERER_CLASSES': [\n        'rest_framework.renderers.JSONRenderer',\n    ],\n}\n\n# Or conditionally\nif not DEBUG:\n    REST_FRAMEWORK['DEFAULT_RENDERER_CLASSES'] = [\n        'rest_framework.renderers.JSONRenderer',\n    ]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Restrict HTTP Methods:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class ArticleViewSet(viewsets.ModelViewSet):\n    http_method_names = ['get', 'post', 'patch', 'delete']  # No PUT\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Custom Error Responses:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Don't expose internal details\ndef custom_exception_handler(exc, context):\n    response = exception_handler(exc, context)\n    \n    if response is not None and not settings.DEBUG:\n        # Hide detailed error messages in production\n        response.data = {\n            'error': 'An error occurred',\n            'code': response.status_code\n        }\n    \n    return response\n\n# settings.py\nREST_FRAMEWORK = {\n    'EXCEPTION_HANDLER': 'myapp.utils.custom_exception_handler'\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Validate and Sanitize Input:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class ArticleSerializer(serializers.ModelSerializer):\n    title = serializers.CharField(max_length=200)\n    content = serializers.CharField()\n    \n    def validate_title(self, value):\n        # Sanitize input\n        import bleach\n        return bleach.clean(value)\n    \n    def validate_content(self, value):\n        # Sanitize HTML content\n        import bleach\n        allowed_tags = ['p', 'br', 'strong', 'em', 'a']\n        return bleach.clean(value, tags=allowed_tags)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"api82019-injection",children:"API8:2019 Injection"}),"\n",(0,r.jsx)(n.h4,{id:"the-problem-7",children:"The Problem"}),"\n",(0,r.jsx)(n.p,{children:"Untrusted data sent to an interpreter as part of a command or query can lead to injection attacks."}),"\n",(0,r.jsx)(n.h4,{id:"sql-injection-prevention",children:"SQL Injection Prevention"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use ORM (Parameterized Queries):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# GOOD - ORM automatically parameterizes\narticles = Article.objects.filter(author__username=username)\n\n# GOOD - Parameterized raw query\nfrom django.db import connection\ncursor = connection.cursor()\ncursor.execute("SELECT * FROM articles WHERE author_id = %s", [author_id])\n\n# BAD - String concatenation\ncursor.execute(f"SELECT * FROM articles WHERE author_id = {author_id}")  # NEVER!\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Avoid Dangerous Methods:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# DANGEROUS - Avoid these with user input\nArticle.objects.raw(f"SELECT * FROM articles WHERE id = {user_input}")  # NO!\nArticle.objects.extra(where=[f"id = {user_input}"])  # NO!\n\n# GOOD - Use parameterization\nArticle.objects.raw("SELECT * FROM articles WHERE id = %s", [user_input])\n'})}),"\n",(0,r.jsx)(n.h4,{id:"command-injection-prevention",children:"Command Injection Prevention"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Avoid eval(), exec(), execfile():"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# NEVER DO THIS\nuser_code = request.data.get('code')\neval(user_code)  # EXTREMELY DANGEROUS\nexec(user_code)  # EXTREMELY DANGEROUS\n"})}),"\n",(0,r.jsx)(n.h4,{id:"yamlpickle-injection-prevention",children:"YAML/Pickle Injection Prevention"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Safe Loaders:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import yaml\n\n# BAD\ndata = yaml.load(user_file)  # Unsafe\n\n# GOOD\ndata = yaml.load(user_file, Loader=yaml.SafeLoader)  # Safe\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Avoid Pickle with User Input:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import pickle\n\n# NEVER load user-controlled pickle files\ndata = pickle.load(user_file)  # DANGEROUS\n\n# Also avoid pandas.read_pickle() with user files\n"})}),"\n",(0,r.jsx)(n.h3,{id:"api92019-improper-assets-management",children:"API9:2019 Improper Assets Management"}),"\n",(0,r.jsx)(n.h4,{id:"the-problem-8",children:"The Problem"}),"\n",(0,r.jsx)(n.p,{children:"Outdated documentation, unnecessary endpoints, and old API versions create attack surfaces."}),"\n",(0,r.jsx)(n.h4,{id:"best-practices-6",children:"Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Maintain API Inventory:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Document all endpoints\nAPI_INVENTORY = {\n    'v1': {\n        'endpoints': ['/api/v1/users/', '/api/v1/articles/'],\n        'status': 'deprecated',\n        'sunset_date': '2024-12-31',\n        'environment': 'production'\n    },\n    'v2': {\n        'endpoints': ['/api/v2/users/', '/api/v2/articles/'],\n        'status': 'active',\n        'environment': 'production'\n    }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Version Your API:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# settings.py\nREST_FRAMEWORK = {\n    'DEFAULT_VERSIONING_CLASS': 'rest_framework.versioning.URLPathVersioning',\n    'DEFAULT_VERSION': 'v2',\n    'ALLOWED_VERSIONS': ['v1', 'v2'],\n}\n\n# urls.py\nurlpatterns = [\n    path('api/v1/', include('myapp.api.v1.urls')),\n    path('api/v2/', include('myapp.api.v2.urls')),\n]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Deprecation Headers:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.response import Response\n\nclass DeprecatedView(APIView):\n    def get(self, request):\n        response = Response({'data': 'some data'})\n        response['Warning'] = '299 - \"Deprecated API. Use /api/v2/ instead\"'\n        response['Sunset'] = 'Sat, 31 Dec 2024 23:59:59 GMT'\n        return response\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Document Everything:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"API version and environment"}),"\n",(0,r.jsx)(n.li,{children:"Authentication methods"}),"\n",(0,r.jsx)(n.li,{children:"Rate limits and SLAs"}),"\n",(0,r.jsx)(n.li,{children:"All endpoints with parameters"}),"\n",(0,r.jsx)(n.li,{children:"Deprecation timelines"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"api102019-insufficient-logging--monitoring",children:"API10:2019 Insufficient Logging & Monitoring"}),"\n",(0,r.jsx)(n.h4,{id:"the-problem-9",children:"The Problem"}),"\n",(0,r.jsx)(n.p,{children:"Lack of logging and monitoring allows attacks to go undetected."}),"\n",(0,r.jsx)(n.h4,{id:"best-practices-7",children:"Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Comprehensive Logging:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import logging\n\nlogger = logging.getLogger(__name__)\n\nclass ArticleViewSet(viewsets.ModelViewSet):\n    queryset = Article.objects.all()\n    serializer_class = ArticleSerializer\n    \n    def create(self, request, *args, **kwargs):\n        logger.info(\n            f\"Article creation attempt by user {request.user.id}\",\n            extra={\n                'user_id': request.user.id,\n                'ip_address': request.META.get('REMOTE_ADDR'),\n                'user_agent': request.META.get('HTTP_USER_AGENT')\n            }\n        )\n        \n        try:\n            response = super().create(request, *args, **kwargs)\n            logger.info(f\"Article {response.data['id']} created successfully\")\n            return response\n        except Exception as e:\n            logger.error(\n                f\"Article creation failed: {str(e)}\",\n                extra={\n                    'user_id': request.user.id,\n                    'error': str(e),\n                    'stack_trace': traceback.format_exc()\n                }\n            )\n            raise\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Log Security Events:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class LoginView(APIView):\n    def post(self, request):\n        username = request.data.get('username')\n        password = request.data.get('password')\n        \n        user = authenticate(username=username, password=password)\n        \n        if user:\n            logger.info(\n                f\"Successful login for user {username}\",\n                extra={\n                    'user_id': user.id,\n                    'ip_address': request.META.get('REMOTE_ADDR')\n                }\n            )\n            token, _ = Token.objects.get_or_create(user=user)\n            return Response({'token': token.key})\n        else:\n            logger.warning(\n                f\"Failed login attempt for username {username}\",\n                extra={\n                    'username': username,\n                    'ip_address': request.META.get('REMOTE_ADDR')\n                }\n            )\n            return Response(\n                {'error': 'Invalid credentials'},\n                status=status.HTTP_401_UNAUTHORIZED\n            )\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What to Log:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All failed authentication attempts"}),"\n",(0,r.jsx)(n.li,{children:"Denied access attempts"}),"\n",(0,r.jsx)(n.li,{children:"Input validation errors"}),"\n",(0,r.jsx)(n.li,{children:"Suspicious activities"}),"\n",(0,r.jsx)(n.li,{children:"API errors with context"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What NOT to Log:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Passwords"}),"\n",(0,r.jsx)(n.li,{children:"API tokens"}),"\n",(0,r.jsx)(n.li,{children:"PII (unless necessary and secured)"}),"\n",(0,r.jsx)(n.li,{children:"Credit card numbers"}),"\n",(0,r.jsx)(n.li,{children:"Other sensitive data"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Structured Logging:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# settings.py\nLOGGING = {\n    'version': 1,\n    'disable_existing_loggers': False,\n    'formatters': {\n        'json': {\n            '()': 'pythonjsonlogger.jsonlogger.JsonFormatter',\n            'format': '%(asctime)s %(name)s %(levelname)s %(message)s'\n        }\n    },\n    'handlers': {\n        'file': {\n            'level': 'INFO',\n            'class': 'logging.handlers.RotatingFileHandler',\n            'filename': '/var/log/django/api.log',\n            'maxBytes': 1024 * 1024 * 15,  # 15MB\n            'backupCount': 10,\n            'formatter': 'json',\n        },\n    },\n    'loggers': {\n        'django': {\n            'handlers': ['file'],\n            'level': 'INFO',\n            'propagate': True,\n        },\n        'myapp': {\n            'handlers': ['file'],\n            'level': 'INFO',\n            'propagate': False,\n        },\n    },\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"other-security-risks",children:"Other Security Risks"}),"\n",(0,r.jsx)(n.h3,{id:"business-logic-bugs",children:"Business Logic Bugs"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevent Race Conditions:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from django.db import transaction\n\nclass TransferView(APIView):\n    @transaction.atomic\n    def post(self, request):\n        # Use select_for_update to prevent race conditions\n        sender = Account.objects.select_for_update().get(id=request.data['sender_id'])\n        receiver = Account.objects.select_for_update().get(id=request.data['receiver_id'])\n        amount = request.data['amount']\n        \n        if sender.balance < amount:\n            raise ValidationError(\"Insufficient funds\")\n        \n        sender.balance -= amount\n        receiver.balance += amount\n        \n        sender.save()\n        receiver.save()\n        \n        return Response({'status': 'success'})\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Validate Business Rules:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class OrderSerializer(serializers.ModelSerializer):\n    def validate(self, data):\n        # Check stock availability\n        if data['quantity'] > data['product'].stock:\n            raise serializers.ValidationError(\"Insufficient stock\")\n        \n        # Check minimum order amount\n        if data['total'] < 10:\n            raise serializers.ValidationError(\"Minimum order amount is $10\")\n        \n        return data\n"})}),"\n",(0,r.jsx)(n.h3,{id:"secret-management",children:"Secret Management"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Never Hardcode Secrets:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# BAD\nSECRET_KEY = 'django-insecure-hardcoded-key-12345'\nDATABASE_PASSWORD = 'mypassword123'\n\n# GOOD - Use environment variables\nSECRET_KEY = os.environ.get('SECRET_KEY')\nDATABASE_PASSWORD = os.environ.get('DB_PASSWORD')\n\n# BETTER - Use secret management service\nfrom azure.keyvault.secrets import SecretClient\nfrom azure.identity import DefaultAzureCredential\n\ncredential = DefaultAzureCredential()\nclient = SecretClient(vault_url=\"https://myvault.vault.azure.net/\", credential=credential)\nSECRET_KEY = client.get_secret(\"django-secret-key\").value\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use django-environ:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import environ\n\nenv = environ.Env()\nenviron.Env.read_env()\n\nSECRET_KEY = env('SECRET_KEY')\nDEBUG = env.bool('DEBUG', default=False)\nDATABASE_URL = env.db()\n"})}),"\n",(0,r.jsx)(n.h2,{id:"dependency-management",children:"Dependency Management"}),"\n",(0,r.jsx)(n.h3,{id:"keep-dependencies-updated",children:"Keep Dependencies Updated"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Regular Updates:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pip list --outdated\npip install --upgrade djangorestframework\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Security Audits:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pip install safety\nsafety check\n\n# Or use pip-audit\npip install pip-audit\npip-audit\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Requirements Management:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# requirements/base.txt\nDjango>=4.2,<5.0\ndjangorestframework>=3.14,<4.0\n\n# requirements/production.txt\n-r base.txt\ngunicorn>=20.1.0\n"})}),"\n",(0,r.jsx)(n.h2,{id:"sast-tools",children:"SAST Tools"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Static Analysis:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Bandit - Python security linter\npip install bandit\nbandit -r myapp/\n\n# Semgrep\npip install semgrep\nsemgrep --config=auto myapp/\n"})}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"Key security best practices:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authorization:"})," Always check object permissions with ",(0,r.jsx)(n.code,{children:"check_object_permissions()"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authentication:"})," Configure properly, never override without understanding"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Data Exposure:"})," Use explicit field lists (allowlist), never ",(0,r.jsx)(n.code,{children:"__all__"})," or ",(0,r.jsx)(n.code,{children:"exclude"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rate Limiting:"})," Implement throttling and pagination"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Permissions:"})," Change default from ",(0,r.jsx)(n.code,{children:"AllowAny"}),", use appropriate permissions per endpoint"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Mass Assignment:"})," Use explicit fields in serializers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Configuration:"})," Secure production settings, disable DEBUG, use HTTPS"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Injection:"})," Use ORM, avoid dangerous methods with user input"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Asset Management:"})," Maintain API inventory, version APIs, document deprecations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Logging:"})," Log security events, but never log sensitive data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Secrets:"})," Never hardcode, use environment variables or secret managers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Dependencies:"})," Keep updated, run security audits regularly"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Following these practices protects your API from the most common security vulnerabilities."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>l,x:()=>a});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);