"use strict";(globalThis.webpackChunkmy_docs=globalThis.webpackChunkmy_docs||[]).push([[670],{5514(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Authentication-and-Permissions","title":"Authentication and Permissions Best Practices","description":"Overview","source":"@site/docs/Authentication-and-Permissions.md","sourceDirName":".","slug":"/Authentication-and-Permissions","permalink":"/django-rest-best-practices/Authentication-and-Permissions","draft":false,"unlisted":false,"editUrl":"https://github.com/pragnakalp/django-rest-best-practices/tree/main/docs/Authentication-and-Permissions.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Views and ViewSets Best Practices","permalink":"/django-rest-best-practices/Views-and-ViewSets"},"next":{"title":"Security Best Practices","permalink":"/django-rest-best-practices/Security-Best-Practices"}}');var r=s(4848),t=s(8453);const o={},l="Authentication and Permissions Best Practices",a={},c=[{value:"Overview",id:"overview",level:2},{value:"Authentication",id:"authentication",level:2},{value:"Understanding Authentication",id:"understanding-authentication",level:3},{value:"Setting Up Authentication",id:"setting-up-authentication",level:3},{value:"Global Authentication Configuration",id:"global-authentication-configuration",level:4},{value:"Authentication Schemes: Detailed Comparison",id:"authentication-schemes-detailed-comparison",level:3},{value:"Approach 1: JWT Authentication (Recommended - Stateless, Scalable)",id:"approach-1-jwt-authentication-recommended---stateless-scalable",level:4},{value:"Approach 2: Token Authentication (\u26a0\ufe0f LEGACY - Not Recommended)",id:"approach-2-token-authentication-\ufe0f-legacy---not-recommended",level:4},{value:"Approach 3: Session Authentication (Traditional Web)",id:"approach-3-session-authentication-traditional-web",level:4},{value:"Approach 4: Basic Authentication (Development Only)",id:"approach-4-basic-authentication-development-only",level:4},{value:"Comprehensive Comparison Matrix",id:"comprehensive-comparison-matrix",level:3},{value:"Decision Tree",id:"decision-tree",level:3},{value:"Best Practice: JWT Authentication (Recommended)",id:"best-practice-jwt-authentication-recommended",level:3},{value:"Alternative: Multiple Authentication Schemes",id:"alternative-multiple-authentication-schemes",level:3},{value:"Real-World Recommendations",id:"real-world-recommendations",level:3},{value:"Per-View Authentication",id:"per-view-authentication",level:3},{value:"Authentication Best Practices",id:"authentication-best-practices",level:3},{value:"Permissions",id:"permissions",level:2},{value:"Understanding Permissions",id:"understanding-permissions",level:3},{value:"Setting Up Permissions",id:"setting-up-permissions",level:3},{value:"Global Permission Configuration",id:"global-permission-configuration",level:4},{value:"Permission Approaches",id:"permission-approaches",level:3},{value:"Approach 1: Basic DRF Permissions (Simple Applications)",id:"approach-1-basic-drf-permissions-simple-applications",level:4},{value:"Approach 2: Advanced RBAC System (Enterprise Applications)",id:"approach-2-advanced-rbac-system-enterprise-applications",level:4},{value:"Built-in Permission Classes",id:"built-in-permission-classes",level:3},{value:"1. AllowAny",id:"1-allowany",level:4},{value:"2. IsAuthenticated",id:"2-isauthenticated",level:4},{value:"3. IsAuthenticatedOrReadOnly",id:"3-isauthenticatedorreadonly",level:4},{value:"4. IsAdminUser",id:"4-isadminuser",level:4},{value:"5. DjangoModelPermissions",id:"5-djangomodelpermissions",level:4},{value:"6. DjangoObjectPermissions",id:"6-djangoobjectpermissions",level:4},{value:"Custom Permission Classes",id:"custom-permission-classes",level:3},{value:"Basic Custom Permission",id:"basic-custom-permission",level:4},{value:"Advanced Custom Permission",id:"advanced-custom-permission",level:4},{value:"Permission with Custom Logic",id:"permission-with-custom-logic",level:4},{value:"Advanced RBAC Permission System",id:"advanced-rbac-permission-system",level:3},{value:"Overview",id:"overview-1",level:4},{value:"Core Architecture",id:"core-architecture",level:4},{value:"Service Layer Implementation",id:"service-layer-implementation",level:4},{value:"DRF Integration",id:"drf-integration",level:4},{value:"Permission Decorator",id:"permission-decorator",level:4},{value:"Database Models",id:"database-models",level:4},{value:"Migration and Setup",id:"migration-and-setup",level:4},{value:"Using Multiple Permissions",id:"using-multiple-permissions",level:3},{value:"Per-Action Permissions",id:"per-action-permissions",level:3},{value:"Object-Level Permissions",id:"object-level-permissions",level:3},{value:"Checking Object Permissions",id:"checking-object-permissions",level:4},{value:"Filtering Queryset by Permissions",id:"filtering-queryset-by-permissions",level:4},{value:"Permission Best Practices",id:"permission-best-practices",level:3},{value:"Basic DRF Permissions",id:"basic-drf-permissions",level:4},{value:"Advanced RBAC System",id:"advanced-rbac-system",level:4},{value:"Migration Strategy",id:"migration-strategy",level:4},{value:"Performance Optimization",id:"performance-optimization",level:4},{value:"Security Considerations",id:"security-considerations",level:4},{value:"Third-Party Authentication Packages",id:"third-party-authentication-packages",level:2},{value:"django-rest-auth",id:"django-rest-auth",level:3},{value:"django-allauth",id:"django-allauth",level:3},{value:"OAuth2",id:"oauth2",level:3},{value:"Security Considerations",id:"security-considerations-1",level:2},{value:"1. Secure Token Storage",id:"1-secure-token-storage",level:3},{value:"2. Token Expiration",id:"2-token-expiration",level:3},{value:"3. Rate Limiting Authentication Endpoints",id:"3-rate-limiting-authentication-endpoints",level:3},{value:"4. HTTPS Only",id:"4-https-only",level:3},{value:"5. Validate User Input",id:"5-validate-user-input",level:3},{value:"Testing Authentication and Permissions",id:"testing-authentication-and-permissions",level:2},{value:"Testing Authentication",id:"testing-authentication",level:3},{value:"Testing Permissions",id:"testing-permissions",level:3},{value:"Testing RBAC Permissions",id:"testing-rbac-permissions",level:3},{value:"Integration Tests",id:"integration-tests",level:3},{value:"Summary",id:"summary",level:2},{value:"Authentication",id:"authentication-1",level:3},{value:"Permissions",id:"permissions-1",level:3},{value:"Migration Strategy",id:"migration-strategy-1",level:3}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"authentication-and-permissions-best-practices",children:"Authentication and Permissions Best Practices"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Authentication identifies users, while permissions determine what authenticated users can do. This document covers best practices for implementing secure authentication and authorization in Django REST Framework."}),"\n",(0,r.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,r.jsx)(n.h3,{id:"understanding-authentication",children:"Understanding Authentication"}),"\n",(0,r.jsx)(n.p,{children:"Authentication determines the identity of a user making a request. DRF supports multiple authentication schemes that can be used together."}),"\n",(0,r.jsx)(n.h3,{id:"setting-up-authentication",children:"Setting Up Authentication"}),"\n",(0,r.jsx)(n.h4,{id:"global-authentication-configuration",children:"Global Authentication Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["Configure authentication in ",(0,r.jsx)(n.code,{children:"settings.py"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# settings.py\nREST_FRAMEWORK = {\n    'DEFAULT_AUTHENTICATION_CLASSES': [\n        'rest_framework_simplejwt.authentication.JWTAuthentication',  # Recommended for modern APIs\n    ],\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Important:"})," Always configure authentication classes. The default allows unauthenticated access."]}),"\n",(0,r.jsx)(n.h3,{id:"authentication-schemes-detailed-comparison",children:"Authentication Schemes: Detailed Comparison"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u26a0\ufe0f RECOMMENDATION:"})," Use JWT authentication for all new projects. Token authentication is considered legacy and maintained only for backward compatibility."]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"approach-1-jwt-authentication-recommended---stateless-scalable",children:"Approach 1: JWT Authentication (Recommended - Stateless, Scalable)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best For:"})," Modern applications, microservices, distributed systems, multi-device support"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Current Industry Standard:"})," JWT is the recommended authentication method for 80%+ of modern API projects."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# pip install djangorestframework-simplejwt\nfrom datetime import timedelta\n\nREST_FRAMEWORK = {\n    'DEFAULT_AUTHENTICATION_CLASSES': [\n        'rest_framework_simplejwt.authentication.JWTAuthentication',\n    ],\n}\n\nSIMPLE_JWT = {\n    'ACCESS_TOKEN_LIFETIME': timedelta(minutes=15),\n    'REFRESH_TOKEN_LIFETIME': timedelta(days=7),\n    'ROTATE_REFRESH_TOKENS': True,\n    'BLACKLIST_AFTER_ROTATION': True,\n    'ALGORITHM': 'HS256',\n    'SIGNING_KEY': SECRET_KEY,\n    'AUTH_HEADER_TYPES': ('Bearer',),\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Stateless (no database lookup)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Built-in expiration"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Refresh token support"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Multi-device support"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Scalable for microservices"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Contains user info in token"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Industry standard (80%+ adoption)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Works seamlessly with mobile and web apps"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cannot revoke until expiration (mitigated with blacklist)"}),"\n",(0,r.jsx)(n.li,{children:"Larger token size than simple tokens"}),"\n",(0,r.jsx)(n.li,{children:"Requires token refresh logic on client"}),"\n",(0,r.jsx)(n.li,{children:"External dependency (djangorestframework-simplejwt)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use When:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"All new projects"})," (recommended default)"]}),"\n",(0,r.jsx)(n.li,{children:"Building microservices"}),"\n",(0,r.jsx)(n.li,{children:"Need stateless authentication"}),"\n",(0,r.jsx)(n.li,{children:"Multi-device support required"}),"\n",(0,r.jsx)(n.li,{children:"Scalability is priority"}),"\n",(0,r.jsx)(n.li,{children:"Modern API development"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Security Considerations:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Short access token lifetime (5-15 min)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Longer refresh token lifetime (7 days)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Implement token blacklist for revocation"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Rotate refresh tokens on use"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Use HTTPS only"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Store tokens securely on client (never in localStorage for web)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"URL Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework_simplejwt.views import TokenObtainPairView, TokenRefreshView\n\nurlpatterns = [\n    path('api/token/', TokenObtainPairView.as_view(), name='token_obtain_pair'),\n    path('api/token/refresh/', TokenRefreshView.as_view(), name='token_refresh'),\n]\n"})}),"\n",(0,r.jsx)(n.h4,{id:"approach-2-token-authentication-\ufe0f-legacy---not-recommended",children:"Approach 2: Token Authentication (\u26a0\ufe0f LEGACY - Not Recommended)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Status:"})," Legacy authentication method. Use JWT for new projects."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best For:"})," Existing projects requiring backward compatibility"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# settings.py\nINSTALLED_APPS = [\n    'rest_framework.authtoken',\n]\n\nREST_FRAMEWORK = {\n    'DEFAULT_AUTHENTICATION_CLASSES': [\n        'rest_framework.authentication.TokenAuthentication',\n    ],\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Simple to implement"}),"\n",(0,r.jsx)(n.li,{children:"Built into DRF"}),"\n",(0,r.jsx)(n.li,{children:"Easy to revoke (delete token)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u274c Tokens stored in database (stateful)"}),"\n",(0,r.jsx)(n.li,{children:"\u274c No expiration by default"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Single token per user (no multi-device)"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Database query per request"}),"\n",(0,r.jsx)(n.li,{children:"\u274c No built-in refresh mechanism"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Not suitable for modern applications"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use When:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Maintaining legacy projects"}),"\n",(0,r.jsx)(n.li,{children:"Backward compatibility required"}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"NOT recommended for new projects"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Security Considerations:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Implement token expiration manually"}),"\n",(0,r.jsx)(n.li,{children:"Store tokens securely on client"}),"\n",(0,r.jsx)(n.li,{children:"Use HTTPS only"}),"\n",(0,r.jsx)(n.li,{children:"Consider migrating to JWT"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"approach-3-session-authentication-traditional-web",children:"Approach 3: Session Authentication (Traditional Web)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best For:"})," Same-origin web apps, Django templates"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"REST_FRAMEWORK = {\n    'DEFAULT_AUTHENTICATION_CLASSES': [\n        'rest_framework.authentication.SessionAuthentication',\n    ],\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Built into Django"}),"\n",(0,r.jsx)(n.li,{children:"Familiar for Django developers"}),"\n",(0,r.jsx)(n.li,{children:"Works with Django auth"}),"\n",(0,r.jsx)(n.li,{children:"CSRF protection included"}),"\n",(0,r.jsx)(n.li,{children:"Good for same-origin requests"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Requires cookies"}),"\n",(0,r.jsx)(n.li,{children:"CSRF token needed"}),"\n",(0,r.jsx)(n.li,{children:"Not suitable for mobile"}),"\n",(0,r.jsx)(n.li,{children:"Same-origin only"}),"\n",(0,r.jsx)(n.li,{children:"Session storage required"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use When:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Building traditional web apps"}),"\n",(0,r.jsx)(n.li,{children:"Using Django templates"}),"\n",(0,r.jsx)(n.li,{children:"Same-origin AJAX requests"}),"\n",(0,r.jsx)(n.li,{children:"Already using Django sessions"}),"\n",(0,r.jsx)(n.li,{children:"Don't need mobile support"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Security Considerations:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Enable CSRF protection"}),"\n",(0,r.jsx)(n.li,{children:"Secure cookie settings"}),"\n",(0,r.jsx)(n.li,{children:"HTTPOnly cookies"}),"\n",(0,r.jsx)(n.li,{children:"SameSite cookie attribute"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"approach-4-basic-authentication-development-only",children:"Approach 4: Basic Authentication (Development Only)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best For:"})," Development, testing, internal tools"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"REST_FRAMEWORK = {\n    'DEFAULT_AUTHENTICATION_CLASSES': [\n        'rest_framework.authentication.BasicAuthentication',\n    ],\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Extremely simple"}),"\n",(0,r.jsx)(n.li,{children:"No setup required"}),"\n",(0,r.jsx)(n.li,{children:"Good for testing"}),"\n",(0,r.jsx)(n.li,{children:"Works everywhere"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cons:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Insecure"})," (credentials in every request)"]}),"\n",(0,r.jsx)(n.li,{children:"No token management"}),"\n",(0,r.jsx)(n.li,{children:"Password exposed in headers"}),"\n",(0,r.jsx)(n.li,{children:"Not suitable for production"}),"\n",(0,r.jsx)(n.li,{children:"No logout mechanism"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use When:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Development/testing only"}),"\n",(0,r.jsx)(n.li,{children:"Internal tools over VPN"}),"\n",(0,r.jsx)(n.li,{children:"Quick prototyping"}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"NEVER for production"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Security Considerations:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Only use over HTTPS"})}),"\n",(0,r.jsx)(n.li,{children:"Only for development"}),"\n",(0,r.jsx)(n.li,{children:"Never in production"}),"\n",(0,r.jsx)(n.li,{children:"Consider alternatives"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"comprehensive-comparison-matrix",children:"Comprehensive Comparison Matrix"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Feature"}),(0,r.jsx)(n.th,{children:"JWT (\u2705 Recommended)"}),(0,r.jsx)(n.th,{children:"Token (Legacy)"}),(0,r.jsx)(n.th,{children:"Session"}),(0,r.jsx)(n.th,{children:"Basic"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Stateless"})}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"\u2705"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Scalability"})}),(0,r.jsx)(n.td,{children:"High"}),(0,r.jsx)(n.td,{children:"Medium"}),(0,r.jsx)(n.td,{children:"Low"}),(0,r.jsx)(n.td,{children:"High"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Mobile Support"})}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"\u2705"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Multi-device"})}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"\u2705"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Revocation"})}),(0,r.jsx)(n.td,{children:"Hard (use blacklist)"}),(0,r.jsx)(n.td,{children:"Easy"}),(0,r.jsx)(n.td,{children:"Easy"}),(0,r.jsx)(n.td,{children:"N/A"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Expiration"})}),(0,r.jsx)(n.td,{children:"Built-in"}),(0,r.jsx)(n.td,{children:"Manual"}),(0,r.jsx)(n.td,{children:"Built-in"}),(0,r.jsx)(n.td,{children:"N/A"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Database Queries"})}),(0,r.jsx)(n.td,{children:"No"}),(0,r.jsx)(n.td,{children:"Yes"}),(0,r.jsx)(n.td,{children:"Yes"}),(0,r.jsx)(n.td,{children:"Yes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Setup Complexity"})}),(0,r.jsx)(n.td,{children:"Medium"}),(0,r.jsx)(n.td,{children:"Low"}),(0,r.jsx)(n.td,{children:"Low"}),(0,r.jsx)(n.td,{children:"None"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Security"})}),(0,r.jsx)(n.td,{children:"Excellent"}),(0,r.jsx)(n.td,{children:"Good"}),(0,r.jsx)(n.td,{children:"Good"}),(0,r.jsx)(n.td,{children:"Poor"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Production Ready"})}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"\u26a0\ufe0f Legacy"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"\u274c"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Recommendation"})}),(0,r.jsxs)(n.td,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Use This"})]}),(0,r.jsx)(n.td,{children:"\u274c Legacy"}),(0,r.jsx)(n.td,{children:"Use for web"}),(0,r.jsx)(n.td,{children:"\u274c Never"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"decision-tree",children:"Decision Tree"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Choose Authentication Scheme:\n\nNew Project?\n\u2514\u2500 Yes \u2192 \u2705 Use JWT (recommended for 95% of cases)\n\nLegacy Project?\n\u251c\u2500 Already using Token Auth? \u2192 Consider migrating to JWT\n\u2514\u2500 Already using Session Auth? \u2192 Keep for same-origin web apps\n\nBuilding mobile app or SPA?\n\u2514\u2500 \u2705 Use JWT (industry standard)\n\nBuilding microservices?\n\u2514\u2500 \u2705 Use JWT (stateless, scalable)\n\nBuilding traditional Django template app?\n\u2514\u2500 Session Auth acceptable (same-origin only)\n\nDevelopment/Testing?\n\u2514\u2500 Basic Auth OK (HTTPS only, never production)\n\n\u26a0\ufe0f DEFAULT RECOMMENDATION: Use JWT for all new projects\n"})}),"\n",(0,r.jsx)(n.h3,{id:"best-practice-jwt-authentication-recommended",children:"Best Practice: JWT Authentication (Recommended)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"JWT is the current best practice for most modern applications"})," due to its stateless nature, scalability, and built-in security features."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# pip install djangorestframework-simplejwt\nREST_FRAMEWORK = {\n    'DEFAULT_AUTHENTICATION_CLASSES': [\n        'rest_framework_simplejwt.authentication.JWTAuthentication',\n    ],\n}\n\nSIMPLE_JWT = {\n    'ACCESS_TOKEN_LIFETIME': timedelta(minutes=15),\n    'REFRESH_TOKEN_LIFETIME': timedelta(days=7),\n    'ROTATE_REFRESH_TOKENS': True,\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Why JWT is Recommended:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Stateless"}),": No database lookups for authentication"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scalable"}),": Perfect for microservices and distributed systems"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Secure"}),": Built-in expiration and refresh token mechanism"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Multi-device"}),": Supports multiple concurrent sessions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Industry Standard"}),": Widely adopted and well-supported"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use JWT For:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Most new applications"})," (default choice)"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Mobile apps"})," (iOS, Android)"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Single Page Applications"})," (React, Vue, Angular)"]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Microservices architecture"})]}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Multi-device support requirements"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"alternative-multiple-authentication-schemes",children:"Alternative: Multiple Authentication Schemes"}),"\n",(0,r.jsx)(n.p,{children:"For applications requiring both web and mobile support:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"REST_FRAMEWORK = {\n    'DEFAULT_AUTHENTICATION_CLASSES': [\n        'rest_framework_simplejwt.authentication.JWTAuthentication',\n        'rest_framework.authentication.SessionAuthentication',\n    ],\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Benefits:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"JWT for mobile/SPA clients"}),"\n",(0,r.jsx)(n.li,{children:"Session for traditional web interface"}),"\n",(0,r.jsx)(n.li,{children:"Flexibility for different client types"}),"\n",(0,r.jsx)(n.li,{children:"Gradual migration path from legacy systems"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"real-world-recommendations",children:"Real-World Recommendations"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Startup/MVP (Recommended):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Start with JWT - modern and scalable\n'rest_framework_simplejwt.authentication.JWTAuthentication'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Production SaaS:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# JWT for scalability and multi-device support\n'rest_framework_simplejwt.authentication.JWTAuthentication'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Enterprise Internal:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# JWT for APIs, Session for internal web tools\n'rest_framework_simplejwt.authentication.JWTAuthentication',\n'rest_framework.authentication.SessionAuthentication',\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Public API:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# JWT for third-party developers\n'rest_framework_simplejwt.authentication.JWTAuthentication'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"URLs:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework_simplejwt.views import (\n    TokenObtainPairView,\n    TokenRefreshView,\n)\n\nurlpatterns = [\n    path('api/token/', TokenObtainPairView.as_view(), name='token_obtain_pair'),\n    path('api/token/refresh/', TokenRefreshView.as_view(), name='token_refresh'),\n]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"per-view-authentication",children:"Per-View Authentication"}),"\n",(0,r.jsx)(n.p,{children:"Override authentication for specific views:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.authentication import TokenAuthentication\nfrom rest_framework.permissions import IsAuthenticated\nfrom rest_framework.views import APIView\n\nclass ArticleView(APIView):\n    authentication_classes = [TokenAuthentication]\n    permission_classes = [IsAuthenticated]\n    \n    def get(self, request):\n        return Response({'message': 'Authenticated with token'})\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Function-based views:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.decorators import api_view, authentication_classes, permission_classes\n\n@api_view(['GET'])\n@authentication_classes([TokenAuthentication])\n@permission_classes([IsAuthenticated])\ndef article_list(request):\n    return Response({'message': 'Authenticated'})\n"})}),"\n",(0,r.jsx)(n.h3,{id:"authentication-best-practices",children:"Authentication Best Practices"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use JWT as default:"})," JWT is the recommended choice for most modern applications"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Always configure authentication:"})," Never rely on DRF defaults"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use HTTPS:"})," Always use HTTPS in production, especially with authentication"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Token security:"})," Store tokens securely on the client side (httpOnly cookies recommended)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Token rotation:"})," Implement refresh token mechanisms for long-lived sessions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Short access tokens:"})," Use 5-15 minute access token lifetime"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Multiple schemes:"})," Support multiple authentication methods when needed"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"permissions",children:"Permissions"}),"\n",(0,r.jsx)(n.h3,{id:"understanding-permissions",children:"Understanding Permissions"}),"\n",(0,r.jsx)(n.p,{children:"Permissions determine whether a request should be granted or denied access. This document covers both basic DRF permissions and an advanced RBAC system for enterprise applications."}),"\n",(0,r.jsx)(n.h3,{id:"setting-up-permissions",children:"Setting Up Permissions"}),"\n",(0,r.jsx)(n.h4,{id:"global-permission-configuration",children:"Global Permission Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# settings.py\nREST_FRAMEWORK = {\n    'DEFAULT_PERMISSION_CLASSES': [\n        'rest_framework.permissions.IsAuthenticated',\n    ],\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Critical Security Note:"})," The default is ",(0,r.jsx)(n.code,{children:"AllowAny"}),", which allows unauthenticated access. Always change this for production APIs."]}),"\n",(0,r.jsx)(n.h3,{id:"permission-approaches",children:"Permission Approaches"}),"\n",(0,r.jsx)(n.h4,{id:"approach-1-basic-drf-permissions-simple-applications",children:"Approach 1: Basic DRF Permissions (Simple Applications)"}),"\n",(0,r.jsx)(n.p,{children:"Use built-in DRF permission classes for simple applications with basic permission needs."}),"\n",(0,r.jsx)(n.h4,{id:"approach-2-advanced-rbac-system-enterprise-applications",children:"Approach 2: Advanced RBAC System (Enterprise Applications)"}),"\n",(0,r.jsx)(n.p,{children:"Implement a sophisticated Role-Based Access Control system for complex permission requirements."}),"\n",(0,r.jsx)(n.h3,{id:"built-in-permission-classes",children:"Built-in Permission Classes"}),"\n",(0,r.jsx)(n.h4,{id:"1-allowany",children:"1. AllowAny"}),"\n",(0,r.jsx)(n.p,{children:"Allows unrestricted access (authenticated or not)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.permissions import AllowAny\n\nclass PublicArticleList(APIView):\n    permission_classes = [AllowAny]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Case:"})," Public endpoints like registration, public content listings."]}),"\n",(0,r.jsx)(n.h4,{id:"2-isauthenticated",children:"2. IsAuthenticated"}),"\n",(0,r.jsx)(n.p,{children:"Requires user to be authenticated."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.permissions import IsAuthenticated\n\nclass PrivateArticleList(APIView):\n    permission_classes = [IsAuthenticated]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Case:"})," Any endpoint requiring a logged-in user."]}),"\n",(0,r.jsx)(n.h4,{id:"3-isauthenticatedorreadonly",children:"3. IsAuthenticatedOrReadOnly"}),"\n",(0,r.jsx)(n.p,{children:"Authenticated users have full access; unauthenticated users have read-only access."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.permissions import IsAuthenticatedOrReadOnly\n\nclass ArticleViewSet(viewsets.ModelViewSet):\n    queryset = Article.objects.all()\n    serializer_class = ArticleSerializer\n    permission_classes = [IsAuthenticatedOrReadOnly]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Case:"})," Public APIs where anyone can read but only authenticated users can modify."]}),"\n",(0,r.jsx)(n.h4,{id:"4-isadminuser",children:"4. IsAdminUser"}),"\n",(0,r.jsx)(n.p,{children:"Only admin users (staff) can access."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.permissions import IsAdminUser\n\nclass AdminOnlyView(APIView):\n    permission_classes = [IsAdminUser]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Case:"})," Admin-only endpoints."]}),"\n",(0,r.jsx)(n.h4,{id:"5-djangomodelpermissions",children:"5. DjangoModelPermissions"}),"\n",(0,r.jsx)(n.p,{children:"Ties into Django's model permissions system."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.permissions import DjangoModelPermissions\n\nclass ArticleViewSet(viewsets.ModelViewSet):\n    queryset = Article.objects.all()\n    serializer_class = ArticleSerializer\n    permission_classes = [DjangoModelPermissions]\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Required Django permissions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"POST"})," requires ",(0,r.jsx)(n.code,{children:"add"})," permission"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"PUT/PATCH"})," requires ",(0,r.jsx)(n.code,{children:"change"})," permission"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"DELETE"})," requires ",(0,r.jsx)(n.code,{children:"delete"})," permission"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GET"})," allowed by default (can be changed)"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"6-djangoobjectpermissions",children:"6. DjangoObjectPermissions"}),"\n",(0,r.jsx)(n.p,{children:"Object-level permissions using django-guardian or similar."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.permissions import DjangoObjectPermissions\n\nclass ArticleViewSet(viewsets.ModelViewSet):\n    queryset = Article.objects.all()\n    serializer_class = ArticleSerializer\n    permission_classes = [DjangoObjectPermissions]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"custom-permission-classes",children:"Custom Permission Classes"}),"\n",(0,r.jsx)(n.h4,{id:"basic-custom-permission",children:"Basic Custom Permission"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from rest_framework import permissions\n\nclass IsOwnerOrReadOnly(permissions.BasePermission):\n    """\n    Custom permission to only allow owners of an object to edit it.\n    """\n    \n    def has_object_permission(self, request, view, obj):\n        # Read permissions are allowed for any request\n        if request.method in permissions.SAFE_METHODS:\n            return True\n        \n        # Write permissions only for owner\n        return obj.owner == request.user\n'})}),"\n",(0,r.jsx)(n.h4,{id:"advanced-custom-permission",children:"Advanced Custom Permission"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class IsOwnerOrAdmin(permissions.BasePermission):\n    """\n    Permission to only allow owners or admin users to access.\n    """\n    message = \'You must be the owner or an admin to perform this action.\'\n    \n    def has_permission(self, request, view):\n        # Check if user is authenticated\n        return request.user and request.user.is_authenticated\n    \n    def has_object_permission(self, request, view, obj):\n        # Admin users have full access\n        if request.user.is_staff:\n            return True\n        \n        # Check if user is the owner\n        return obj.owner == request.user\n'})}),"\n",(0,r.jsx)(n.h4,{id:"permission-with-custom-logic",children:"Permission with Custom Logic"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class CanEditArticle(permissions.BasePermission):\n    """\n    Permission to check if user can edit article based on multiple conditions.\n    """\n    \n    def has_object_permission(self, request, view, obj):\n        # Admin can always edit\n        if request.user.is_staff:\n            return True\n        \n        # Owner can edit if article is not published\n        if obj.author == request.user:\n            if not obj.published:\n                return True\n            # Published articles can only be edited within 24 hours\n            from django.utils import timezone\n            time_since_publish = timezone.now() - obj.published_date\n            return time_since_publish.total_seconds() < 86400  # 24 hours\n        \n        # Editors can edit any unpublished article\n        if request.user.groups.filter(name=\'Editors\').exists():\n            return not obj.published\n        \n        return False\n'})}),"\n",(0,r.jsx)(n.h3,{id:"advanced-rbac-permission-system",children:"Advanced RBAC Permission System"}),"\n",(0,r.jsx)(n.h4,{id:"overview-1",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"For enterprise applications requiring sophisticated permission management, implement a Role-Based Access Control (RBAC) system with the following features:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Feature-action-permission hierarchy"})," for granular control"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Role inheritance"})," for scalable permission management"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"User-specific overrides"})," for temporary permissions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Multi-tenancy support"})," with organization scoping"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Comprehensive audit logging"})," for security compliance"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Built-in caching"})," for performance optimization"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"core-architecture",children:"Core Architecture"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Permission resolution order:\n# 1. Superuser \u2192 Always granted all permissions\n# 2. User Overrides \u2192 Individual grants/revokes (highest priority)\n# 3. Role Permissions \u2192 Including parent role inheritance\n# 4. Organization Context \u2192 Must be active member\n\n# Feature-Action-Permission Model:\n# Feature (voice_agents, campaigns, calls)\n#     \u2193\n# Action (create, read, update, delete, execute, export, import, manage)\n#     \u2193\n# Permission = Feature + Action (campaigns:create)\n#     \u2193\n# Role (collection of permissions)\n#     \u2193\n# User (assigned to roles with possible overrides)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"service-layer-implementation",children:"Service Layer Implementation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# apps/permissions/services.py\nfrom django.core.cache import cache\nfrom django.db import transaction\nfrom .models import Feature, Action, Permission, Role, UserPermissionOverride\n\nclass PermissionService:\n    CACHE_TIMEOUT = 300  # 5 minutes\n    \n    @classmethod\n    def check_user_permission(cls, user, feature_code, action, organization_id):\n        """\n        Check if user has permission for specific feature-action in organization.\n        """\n        # Check cache first\n        cache_key = f"perm:{user.id}:{organization_id}:{feature_code}:{action}"\n        cached_result = cache.get(cache_key)\n        if cached_result is not None:\n            return cached_result\n        \n        # 1. Superuser check\n        if user.is_superuser:\n            cls._set_cache(cache_key, True)\n            return True\n        \n        # 2. User overrides check\n        override = cls._check_user_override(user, feature_code, action, organization_id)\n        if override is not None:\n            cls._set_cache(cache_key, override)\n            return override\n        \n        # 3. Role permissions check\n        has_role_permission = cls._check_role_permissions(user, feature_code, action, organization_id)\n        cls._set_cache(cache_key, has_role_permission)\n        return has_role_permission\n    \n    @classmethod\n    def get_user_permissions(cls, user, organization_id):\n        """\n        Get all permissions for user in organization.\n        """\n        permissions = set()\n        \n        # Get role permissions\n        user_roles = cls._get_user_roles(user, organization_id)\n        for role in user_roles:\n            role_perms = cls._get_role_permissions(role)\n            permissions.update(role_perms)\n        \n        # Apply user overrides\n        overrides = cls._get_user_overrides(user, organization_id)\n        for override in overrides:\n            perm_key = f"{override.permission.feature.code}:{override.permission.action.code}"\n            if override.override_type == \'grant\':\n                permissions.add(perm_key)\n            elif override.override_type == \'revoke\':\n                permissions.discard(perm_key)\n        \n        return permissions\n    \n    @classmethod\n    def grant_user_permission(cls, user, organization, permission_id, granted_by, reason=None, expires_at=None):\n        """\n        Grant specific permission to user with optional expiration.\n        """\n        with transaction.atomic():\n            permission = Permission.objects.get(id=permission_id)\n            override = UserPermissionOverride.objects.create(\n                user=user,\n                organization=organization,\n                permission=permission,\n                override_type=\'grant\',\n                granted_by=granted_by,\n                reason=reason,\n                expires_at=expires_at\n            )\n            \n            # Clear cache\n            cls._clear_user_cache(user, organization.id)\n            \n            # Log audit trail\n            cls._log_permission_change(\'permission_granted\', granted_by, user, permission, reason)\n            \n            return override\n    \n    @classmethod\n    def revoke_user_permission(cls, user, organization, permission_id, revoked_by, reason=None):\n        """\n        Revoke specific permission from user.\n        """\n        with transaction.atomic():\n            permission = Permission.objects.get(id=permission_id)\n            override = UserPermissionOverride.objects.create(\n                user=user,\n                organization=organization,\n                permission=permission,\n                override_type=\'revoke\',\n                granted_by=revoked_by,\n                reason=reason\n            )\n            \n            # Clear cache\n            cls._clear_user_cache(user, organization.id)\n            \n            # Log audit trail\n            cls._log_permission_change(\'permission_revoked\', revoked_by, user, permission, reason)\n            \n            return override\n'})}),"\n",(0,r.jsx)(n.h4,{id:"drf-integration",children:"DRF Integration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# apps/permissions/permissions.py\nfrom rest_framework import permissions\nfrom .services import PermissionService\n\nclass FeaturePermission(permissions.BasePermission):\n    \"\"\"\n    DRF permission class that integrates with RBAC system.\n    \"\"\"\n    def __init__(self, feature_code, action):\n        self.feature_code = feature_code\n        self.action = action\n    \n    def has_permission(self, request, view):\n        if not request.user or not request.user.is_authenticated:\n            return False\n        \n        return PermissionService.check_user_permission(\n            user=request.user,\n            feature_code=self.feature_code,\n            action=self.action,\n            organization_id=getattr(request, 'organization_id', None)\n        )\n    \n    def has_object_permission(self, request, view, obj):\n        # For object-level permissions, check additional constraints\n        return self.has_permission(request, view)\n\n# Usage in ViewSets\nclass CampaignViewSet(viewsets.ModelViewSet):\n    def get_permissions(self):\n        if self.action == 'create':\n            return [FeaturePermission('campaigns', 'create')]\n        elif self.action in ['update', 'partial_update']:\n            return [FeaturePermission('campaigns', 'update')]\n        elif self.action == 'destroy':\n            return [FeaturePermission('campaigns', 'delete')]\n        else:  # list, retrieve\n            return [FeaturePermission('campaigns', 'read')]\n"})}),"\n",(0,r.jsx)(n.h4,{id:"permission-decorator",children:"Permission Decorator"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# apps/permissions/decorators.py\nfrom functools import wraps\nfrom django.http import HttpResponseForbidden\nfrom .services import PermissionService\n\ndef require_permission(feature_code, action):\n    """\n    Decorator for function-based views requiring specific permission.\n    """\n    def decorator(view_func):\n        @wraps(view_func)\n        def wrapper(request, *args, **kwargs):\n            if not PermissionService.check_user_permission(\n                user=request.user,\n                feature_code=feature_code,\n                action=action,\n                organization_id=getattr(request, \'organization_id\', None)\n            ):\n                return HttpResponseForbidden("Insufficient permissions")\n            return view_func(request, *args, **kwargs)\n        return wrapper\n    return decorator\n\n# Usage\n@require_permission(\'campaigns\', \'create\')\ndef create_campaign(request):\n    # View logic\n    pass\n'})}),"\n",(0,r.jsx)(n.h4,{id:"database-models",children:"Database Models"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# apps/permissions/models.py\nimport uuid\nfrom django.db import models\nfrom django.contrib.auth import get_user_model\n\nUser = get_user_model()\n\nclass Feature(models.Model):\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    name = models.CharField(max_length=100)\n    code = models.CharField(max_length=100, unique=True)\n    category = models.CharField(max_length=50)\n    is_active = models.BooleanField(default=True)\n    \n    class Meta:\n        db_table = 'features'\n\nclass Action(models.Model):\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    name = models.CharField(max_length=50, unique=True)\n    code = models.CharField(max_length=50, unique=True)\n    is_active = models.BooleanField(default=True)\n    \n    class Meta:\n        db_table = 'actions'\n\nclass Permission(models.Model):\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    feature = models.ForeignKey(Feature, on_delete=models.CASCADE)\n    action = models.ForeignKey(Action, on_delete=models.CASCADE)\n    constraints = models.JSONField(default=dict)\n    is_active = models.BooleanField(default=True)\n    \n    class Meta:\n        unique_together = ['feature', 'action']\n        db_table = 'permissions'\n\nclass Role(models.Model):\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    name = models.CharField(max_length=100)\n    code = models.CharField(max_length=100)\n    organization = models.ForeignKey('organizations.Organization', on_delete=models.CASCADE, null=True)\n    parent_role = models.ForeignKey('self', on_delete=models.CASCADE, null=True)\n    is_system_role = models.BooleanField(default=False)\n    is_active = models.BooleanField(default=True)\n    \n    class Meta:\n        unique_together = ['code', 'organization']\n        db_table = 'roles'\n\nclass RolePermission(models.Model):\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    role = models.ForeignKey(Role, on_delete=models.CASCADE)\n    permission = models.ForeignKey(Permission, on_delete=models.CASCADE)\n    granted_at = models.DateTimeField(auto_now_add=True)\n    granted_by = models.ForeignKey(User, on_delete=models.SET_NULL, null=True)\n    \n    class Meta:\n        unique_together = ['role', 'permission']\n        db_table = 'role_permissions'\n\nclass UserPermissionOverride(models.Model):\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    user = models.ForeignKey(User, on_delete=models.CASCADE)\n    organization = models.ForeignKey('organizations.Organization', on_delete=models.CASCADE)\n    permission = models.ForeignKey(Permission, on_delete=models.CASCADE)\n    override_type = models.CharField(max_length=10, choices=[('grant', 'Grant'), ('revoke', 'Revoke')])\n    expires_at = models.DateTimeField(null=True, blank=True)\n    reason = models.TextField(blank=True)\n    granted_by = models.ForeignKey(User, on_delete=models.SET_NULL, null=True, related_name='granted_overrides')\n    is_active = models.BooleanField(default=True)\n    \n    class Meta:\n        unique_together = ['user', 'organization', 'permission']\n        db_table = 'user_permission_overrides'\n\nclass PermissionAuditLog(models.Model):\n    id = models.UUIDField(primary_key=True, default=uuid.uuid4)\n    organization = models.ForeignKey('organizations.Organization', on_delete=models.CASCADE)\n    action_type = models.CharField(max_length=30)\n    actor = models.ForeignKey(User, on_delete=models.CASCADE, related_name='permission_actions')\n    target_user = models.ForeignKey(User, on_delete=models.CASCADE, related_name='permission_received', null=True)\n    permission = models.ForeignKey(Permission, on_delete=models.CASCADE, null=True)\n    details = models.JSONField(default=dict)\n    ip_address = models.GenericIPAddressField(null=True)\n    user_agent = models.TextField(blank=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n    \n    class Meta:\n        db_table = 'permission_audit_logs'\n"})}),"\n",(0,r.jsx)(n.h4,{id:"migration-and-setup",children:"Migration and Setup"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Create standard features\nfeatures = [\n    ('voice_agents', 'Voice Agents', 'core'),\n    ('campaigns', 'Campaigns', 'core'),\n    ('calls', 'Call Management', 'core'),\n    ('analytics', 'Analytics', 'advanced'),\n    ('billing', 'Billing', 'admin'),\n    ('settings', 'Settings', 'admin'),\n]\n\nfor code, name, category in features:\n    Feature.objects.get_or_create(\n        code=code,\n        defaults={'name': name, 'category': category}\n    )\n\n# Create standard actions\nactions = ['create', 'read', 'update', 'delete', 'execute', 'export', 'import', 'manage']\nfor action in actions:\n    Action.objects.get_or_create(code=action, defaults={'name': action})\n\n# Create permissions for all feature-action combinations\nfor feature in Feature.objects.all():\n    for action in Action.objects.all():\n        Permission.objects.get_or_create(\n            feature=feature,\n            action=action,\n            defaults={'is_active': True}\n        )\n"})}),"\n",(0,r.jsx)(n.h3,{id:"using-multiple-permissions",children:"Using Multiple Permissions"}),"\n",(0,r.jsx)(n.p,{children:"Combine multiple permission classes (all must pass)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class ArticleViewSet(viewsets.ModelViewSet):\n    queryset = Article.objects.all()\n    serializer_class = ArticleSerializer\n    permission_classes = [IsAuthenticated, IsOwnerOrReadOnly]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"per-action-permissions",children:"Per-Action Permissions"}),"\n",(0,r.jsx)(n.p,{children:"Set different permissions for different actions."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.permissions import IsAuthenticated, IsAuthenticatedOrReadOnly, IsAdminUser\n\nclass ArticleViewSet(viewsets.ModelViewSet):\n    queryset = Article.objects.all()\n    serializer_class = ArticleSerializer\n    \n    def get_permissions(self):\n        \"\"\"\n        Instantiate and return the list of permissions for this view.\n        \"\"\"\n        if self.action in ['list', 'retrieve']:\n            permission_classes = [IsAuthenticatedOrReadOnly]\n        elif self.action == 'create':\n            permission_classes = [IsAuthenticated]\n        elif self.action in ['update', 'partial_update', 'destroy']:\n            permission_classes = [IsAuthenticated, IsOwnerOrAdmin]\n        else:\n            permission_classes = [IsAdminUser]\n        \n        return [permission() for permission in permission_classes]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"object-level-permissions",children:"Object-Level Permissions"}),"\n",(0,r.jsx)(n.h4,{id:"checking-object-permissions",children:"Checking Object Permissions"}),"\n",(0,r.jsx)(n.p,{children:"Always check object permissions when retrieving objects."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from rest_framework.exceptions import PermissionDenied\n\nclass ArticleViewSet(viewsets.ModelViewSet):\n    queryset = Article.objects.all()\n    serializer_class = ArticleSerializer\n    permission_classes = [IsAuthenticated, IsOwnerOrReadOnly]\n    \n    def get_object(self):\n        """\n        Override to ensure object permissions are checked.\n        """\n        obj = get_object_or_404(self.get_queryset(), pk=self.kwargs["pk"])\n        self.check_object_permissions(self.request, obj)\n        return obj\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Critical Security:"})," Never override ",(0,r.jsx)(n.code,{children:"get_object()"})," without checking permissions. This is API1:2019 Broken Object Level Authorization."]}),"\n",(0,r.jsx)(n.h4,{id:"filtering-queryset-by-permissions",children:"Filtering Queryset by Permissions"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class ArticleViewSet(viewsets.ModelViewSet):\n    serializer_class = ArticleSerializer\n    permission_classes = [IsAuthenticated]\n    \n    def get_queryset(self):\n        """\n        Return only articles the user has permission to see.\n        """\n        user = self.request.user\n        \n        if user.is_staff:\n            return Article.objects.all()\n        else:\n            # Users see published articles and their own articles\n            return Article.objects.filter(\n                Q(published=True) | Q(author=user)\n            )\n'})}),"\n",(0,r.jsx)(n.h3,{id:"permission-best-practices",children:"Permission Best Practices"}),"\n",(0,r.jsx)(n.h4,{id:"basic-drf-permissions",children:"Basic DRF Permissions"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Change default permissions:"})," Never use ",(0,r.jsx)(n.code,{children:"AllowAny"})," as default"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Principle of least privilege:"})," Grant minimum necessary permissions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Check object permissions:"})," Always use ",(0,r.jsx)(n.code,{children:"check_object_permissions()"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Don't override without checking:"})," Never override authentication/permission classes without understanding impact"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use custom permissions:"})," Create reusable permission classes for complex logic"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Test permissions:"})," Write tests for all permission scenarios"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Document permissions:"})," Clearly document what permissions are required for each endpoint"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"advanced-rbac-system",children:"Advanced RBAC System"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use service layer:"})," Always use ",(0,r.jsx)(n.code,{children:"PermissionService"})," methods, not direct model access"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cache management:"})," Clear cache appropriately after permission changes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Audit logging:"})," Ensure all permission changes go through service methods"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Role design:"})," Keep roles focused and use inheritance for common permissions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Override expiration:"})," Set expiration dates for temporary permission grants"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance monitoring:"})," Monitor permission check performance and cache hit rates"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Security audits:"})," Regular permission audits and review of overrides"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"migration-strategy",children:"Migration Strategy"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Start simple:"})," Use basic DRF permissions for new projects"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Identify complexity:"})," Migrate to RBAC when you need:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Multi-tenancy support"}),"\n",(0,r.jsx)(n.li,{children:"Complex permission hierarchies"}),"\n",(0,r.jsx)(n.li,{children:"User-specific overrides"}),"\n",(0,r.jsx)(n.li,{children:"Audit trail requirements"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Gradual migration:"})," Implement RBAC alongside existing permissions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Testing:"})," Comprehensive test coverage for both systems during migration"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Database indexes:"})," Create indexes on permission-related fields"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Caching strategy:"})," Use Redis for distributed caching in production"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Query optimization:"})," Minimize N+1 queries in permission checks"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cache warming:"})," Pre-populate cache for frequently accessed permissions"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Principle of least privilege:"})," Default roles should have minimal permissions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Audit trails:"})," Maintain complete audit logs of all permission changes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Override monitoring:"})," Monitor for unusual permission override patterns"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Regular reviews:"})," Schedule regular permission audits and reviews"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"third-party-authentication-packages",children:"Third-Party Authentication Packages"}),"\n",(0,r.jsx)(n.h3,{id:"django-rest-auth",children:"django-rest-auth"}),"\n",(0,r.jsx)(n.p,{children:"Provides registration, login, logout, password reset endpoints."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pip install dj-rest-auth\n"})}),"\n",(0,r.jsx)(n.h3,{id:"django-allauth",children:"django-allauth"}),"\n",(0,r.jsx)(n.p,{children:"Social authentication (Google, Facebook, GitHub, etc.)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pip install django-allauth\npip install dj-rest-auth[with_social]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"oauth2",children:"OAuth2"}),"\n",(0,r.jsx)(n.p,{children:"For OAuth2 provider/consumer functionality."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pip install django-oauth-toolkit\n"})}),"\n",(0,r.jsx)(n.h2,{id:"security-considerations-1",children:"Security Considerations"}),"\n",(0,r.jsx)(n.h3,{id:"1-secure-token-storage",children:"1. Secure Token Storage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Bad - Storing tokens in localStorage (vulnerable to XSS)\nlocalStorage.setItem('token', token);\n\n# Good - Use httpOnly cookies or secure storage\n# Server sets httpOnly cookie, or use secure mobile storage\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-token-expiration",children:"2. Token Expiration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Implement token expiration\nfrom datetime import timedelta\nfrom django.utils import timezone\n\nclass ExpiringToken(models.Model):\n    user = models.OneToOneField(User, on_delete=models.CASCADE)\n    token = models.CharField(max_length=40)\n    created = models.DateTimeField(auto_now_add=True)\n    \n    def is_expired(self):\n        return timezone.now() > self.created + timedelta(hours=24)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-rate-limiting-authentication-endpoints",children:"3. Rate Limiting Authentication Endpoints"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.throttling import AnonRateThrottle\n\nclass LoginRateThrottle(AnonRateThrottle):\n    rate = '5/hour'  # 5 login attempts per hour\n\nclass LoginView(APIView):\n    throttle_classes = [LoginRateThrottle]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-https-only",children:"4. HTTPS Only"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# settings.py - Force HTTPS in production\nSECURE_SSL_REDIRECT = True\nSESSION_COOKIE_SECURE = True\nCSRF_COOKIE_SECURE = True\n"})}),"\n",(0,r.jsx)(n.h3,{id:"5-validate-user-input",children:"5. Validate User Input"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class LoginSerializer(serializers.Serializer):\n    username = serializers.CharField(max_length=150)\n    password = serializers.CharField(max_length=128, write_only=True)\n    \n    def validate_username(self, value):\n        # Prevent username enumeration\n        if not User.objects.filter(username=value).exists():\n            raise serializers.ValidationError("Invalid credentials")\n        return value\n'})}),"\n",(0,r.jsx)(n.h2,{id:"testing-authentication-and-permissions",children:"Testing Authentication and Permissions"}),"\n",(0,r.jsx)(n.h3,{id:"testing-authentication",children:"Testing Authentication"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rest_framework.test import APITestCase\nfrom rest_framework.authtoken.models import Token\n\nclass ArticleAPITestCase(APITestCase):\n    def setUp(self):\n        self.user = User.objects.create_user(\n            username='testuser',\n            password='testpass123'\n        )\n        self.token = Token.objects.create(user=self.user)\n    \n    def test_authenticated_request(self):\n        self.client.credentials(HTTP_AUTHORIZATION='Token ' + self.token.key)\n        response = self.client.get('/api/articles/')\n        self.assertEqual(response.status_code, 200)\n    \n    def test_unauthenticated_request(self):\n        response = self.client.get('/api/articles/')\n        self.assertEqual(response.status_code, 401)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"testing-permissions",children:"Testing Permissions"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class ArticlePermissionTestCase(APITestCase):\n    def setUp(self):\n        self.owner = User.objects.create_user(username='owner')\n        self.other_user = User.objects.create_user(username='other')\n        self.article = Article.objects.create(\n            title='Test Article',\n            author=self.owner\n        )\n    \n    def test_owner_can_edit(self):\n        self.client.force_authenticate(user=self.owner)\n        response = self.client.patch(\n            f'/api/articles/{self.article.id}/',\n            {'title': 'Updated Title'}\n        )\n        self.assertEqual(response.status_code, 200)\n    \n    def test_non_owner_cannot_edit(self):\n        self.client.force_authenticate(user=self.other_user)\n        response = self.client.patch(\n            f'/api/articles/{self.article.id}/',\n            {'title': 'Updated Title'}\n        )\n        self.assertEqual(response.status_code, 403)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"testing-rbac-permissions",children:"Testing RBAC Permissions"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class TestRBACPermissions(APITestCase):\n    def setUp(self):\n        self.user = User.objects.create_user('test@example.com')\n        self.org = Organization.objects.create(name='Test Org')\n        self.feature = Feature.objects.create(name='Campaigns', code='campaigns')\n        self.action = Action.objects.create(name='create', code='create')\n        self.permission = Permission.objects.create(\n            feature=self.feature,\n            action=self.action\n        )\n    \n    def test_permission_check_without_role(self):\n        result = PermissionService.check_user_permission(\n            user=self.user,\n            feature_code='campaigns',\n            action='create',\n            organization_id=self.org.id\n        )\n        self.assertFalse(result)\n    \n    def test_permission_check_with_role(self):\n        role = Role.objects.create(name='Test Role', organization=self.org)\n        RolePermission.objects.create(role=role, permission=self.permission)\n        \n        # Assign role to user\n        OrganizationMember.objects.create(\n            user=self.user,\n            organization=self.org,\n            role=role\n        )\n        \n        result = PermissionService.check_user_permission(\n            user=self.user,\n            feature_code='campaigns',\n            action='create',\n            organization_id=self.org.id\n        )\n        self.assertTrue(result)\n    \n    def test_user_override_grant(self):\n        # Grant temporary permission\n        PermissionService.grant_user_permission(\n            user=self.user,\n            organization=self.org,\n            permission_id=self.permission.id,\n            granted_by=self.admin_user,\n            expires_at=timezone.now() + timedelta(hours=1)\n        )\n        \n        result = PermissionService.check_user_permission(\n            user=self.user,\n            feature_code='campaigns',\n            action='create',\n            organization_id=self.org.id\n        )\n        self.assertTrue(result)\n    \n    def test_user_override_revoke(self):\n        # Grant role permission first\n        role = Role.objects.create(name='Test Role', organization=self.org)\n        RolePermission.objects.create(role=role, permission=self.permission)\n        OrganizationMember.objects.create(\n            user=self.user,\n            organization=self.org,\n            role=role\n        )\n        \n        # Revoke specific permission\n        PermissionService.revoke_user_permission(\n            user=self.user,\n            organization=self.org,\n            permission_id=self.permission.id,\n            revoked_by=self.admin_user\n        )\n        \n        result = PermissionService.check_user_permission(\n            user=self.user,\n            feature_code='campaigns',\n            action='create',\n            organization_id=self.org.id\n        )\n        self.assertFalse(result)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"integration-tests",children:"Integration Tests"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class TestPermissionAPI(APITestCase):\n    def test_campaign_creation_requires_permission(self):\n        # Test without permission\n        response = self.client.post('/api/campaigns/', {})\n        self.assertEqual(response.status_code, 403)\n        \n        # Grant permission\n        PermissionService.grant_user_permission(\n            user=self.user,\n            organization=self.org,\n            permission_id=self.permission.id,\n            granted_by=self.admin_user\n        )\n        \n        # Test with permission\n        response = self.client.post('/api/campaigns/', {})\n        self.assertEqual(response.status_code, 201)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"Key authentication and permission best practices:"}),"\n",(0,r.jsx)(n.h3,{id:"authentication-1",children:"Authentication"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use JWT as default:"})," JWT is the recommended choice for most modern applications"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Always configure authentication:"})," Never rely on DRF defaults"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use appropriate schemes:"})," JWT for APIs/SPAs, Session for traditional web apps"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Secure transmission:"})," Always use HTTPS in production"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Token management:"})," Implement expiration, refresh, and secure storage"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Short access tokens:"})," Use 5-15 minute access token lifetime for security"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Multiple schemes:"})," Support multiple authentication methods when needed"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"permissions-1",children:"Permissions"}),"\n",(0,r.jsxs)(n.ol,{start:"8",children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Choose the right approach:"})," Basic DRF permissions for simple apps, RBAC for enterprise"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Principle of least privilege:"})," Grant minimum necessary permissions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Object-level checks:"})," Always check object permissions with ",(0,r.jsx)(n.code,{children:"check_object_permissions()"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Service layer abstraction:"})," Use service methods for RBAC operations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Audit trails:"})," Maintain complete audit logs of permission changes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance optimization:"})," Implement caching and database indexes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Comprehensive testing:"})," Test all permission scenarios and edge cases"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Regular security audits:"})," Review permissions and overrides periodically"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"migration-strategy-1",children:"Migration Strategy"}),"\n",(0,r.jsxs)(n.ol,{start:"16",children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Start with JWT:"})," Begin with JWT authentication for modern applications"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scale permissions:"})," Migrate to RBAC as permission complexity grows"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Maintain compatibility:"})," Ensure smooth transition between systems"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Following these practices ensures your API is secure, scalable, and properly controls access to resources using the most appropriate permission system for your application's needs."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>o,x:()=>l});var i=s(6540);const r={},t=i.createContext(r);function o(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);